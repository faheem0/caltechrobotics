8086/87/88/186 MACRO ASSEMBLER    BOOT                                                     21:13:40  06/18/:8  PAGE    1


DOS 5.0 (038-N) 8086/87/88/186 MACRO ASSEMBLER V3.1 ASSEMBLY OF MODULE BOOT
OBJECT MODULE PLACED IN BOOTCODE.OBJ
ASSEMBLER INVOKED BY:  C:\ASMSTU~1\ASM86.EXE BOOTCODE.ASM M1 DB EP


LOC  OBJ                  LINE     SOURCE

                             1             NAME    BOOT
                             2                     
                             3     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                             4     ;                                                                            ;
                             5     ;                                   Boot Code                                ;
                             6     ;                       For booting mp3 player from ROM                      ;
                             7     ;                                                                            ;
                             8     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
                                      
                             9     
                            10     ; Description:      This program contains boot code to start the mp3 player
                            11     ;                               from ROM.
                            12     ; Input:            None.
                            13     ; Output:           None.
                            14     ; User Interface:   None.
                            15     ; Error Handling:   None.
                            16     ; Algorithms:       None.
                            17     ; Data Structures:  None.
                            18     ;
                            19     ; Revision History:
                            20     ;     4/26/08  Samuel Yang  file started
                            21     ;     6/11/08  Samuel Yang      code debugged, works
                            22     
                            23 +1  $INCLUDE(bootcode.INC)
                      =1    24     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      =1    25     ;                                                                            ;
                      =1    26     ;                                  bootcode.INC                              ;
                      =1    27     ;                              Boot Code Register Values                     ;
                      =1    28     ;                                 Include File                               ;
                      =1    29     ;                                                                            ;
                      =1    30     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      =1    31     
                      =1    32     ; This file contains the definitions for bootcode.asm
                      =1    33     ;
                      =1    34     ; Revision History:
                      =1    35     
                      =1    36     ;     4/26/2008 Samuel Yang     File started
                      =1    37     
  FFA0                =1    38     UCSCtrl equ 0FFA0h              ;address of UCMS
  3000                =1    39     UCSCtrlVal     EQU     3000H          ;value to write to UCS Ctrl Register
                      =1    40                                             ;--11000000------  starting address 0F0000h (
                                   64k)
                      =1    41                                             ;-------------0--  enable bus ready
                      =1    42                                             ;--------------00  0 wait states             
                                                              ;----000000------  reserved
  FFA2                =1    43     LCSCtrl equ 0FFA2h              ;address of LCMS                                     
                                      
  07C0                =1    44     LCSCtrlVal     EQU     07C0H          ;value to write to LCS Ctrl Register
                      =1    45                                             ;--00011111------  ending address 07FFFFh (32
                                   k)
8086/87/88/186 MACRO ASSEMBLER    BOOT                                                     21:13:40  06/18/:8  PAGE    2


LOC  OBJ                  LINE     SOURCE

                      =1    46                                             ;-------------0--  enable bus ready
                      =1    47                                             ;--------------00  0 wait states 
                            48     
                            49     ;segment register assumptions (only CS for this code)
                            50     ASSUME CS:BOOT
                            51     
                            52     EXTRN Start:FAR ;declare the startup code, must be FAR
                            53     
                            54     ;the actual boot code-should be located at FFFF:0000
----                        55     BOOT SEGMENT WORD PUBLIC 'BOOT'
                            56     
0000                        57     BootUp:
0000 BAA0FF                 58     MOV DX, UCSCtrl ;setup UCS control register to match ROM size
0003 B80030                 59     MOV AX, UCSCtrlVal
0006 EE                     60     OUT DX,AL               
                            61     
0007 EA0000----     E       62     JMP Start               ;UCS is setup, now jump (FAR) to startup code
                            63     
----                        64     BOOT ENDS
                            65     
                            66     END

ASSEMBLY COMPLETE, NO ERRORS FOUND
